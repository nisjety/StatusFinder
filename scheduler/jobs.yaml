# DiscoveryBot Scheduler - Job Definitions
# This file defines recurring jobs that are automatically loaded on scheduler startup
---

# Daily quick health check (HEAD requests)
quick_daily_healthcheck:
  schedule_type: cron
  hour: 6  # Run at 6 AM UTC
  minute: 0
  day_of_week: "*"  # Every day
  spider_type: quick  # QuickLinkSpider (HEAD only)
  urls:
    - https://example.com
    - https://example.com/status
    - https://example.com/health
  ignore_cache: true
  user_id: scheduler
  coalesce: true  # Only run once if multiple executions are missed
  misfire_grace_time: 3600  # Grace period of 1 hour for missed jobs

# Weekly crawl (depth 1)
weekly_domain_crawl:
  schedule_type: cron
  day_of_week: sun  # Every Sunday
  hour: 2  # Run at 2 AM UTC
  minute: 0
  spider_type: multi  # MultiDiscoverySpider
  urls:
    - https://example.com
  depth: 1
  mode: domain
  follow_redirects: smart
  custom_settings:
    CLOSESPIDER_TIMEOUT: 7200  # 2 hours max
    DOWNLOAD_DELAY: 1.0

# Monthly enhanced deep crawl
monthly_enhanced_crawl:
  schedule_type: cron
  day: 1  # First day of month
  hour: 1  # Run at 1 AM UTC
  minute: 0
  spider_type: enhanced  # SEODiscoverySpider
  urls:
    - https://example.com
  depth: 2
  mode: domain
  follow_redirects: smart
  custom_settings:
    CLOSESPIDER_TIMEOUT: 14400  # 4 hours max
    DOWNLOAD_DELAY: 2.0
    LOG_LEVEL: INFO

# Visual site map update (every two weeks)
visual_sitemap:
  schedule_type: interval
  weeks: 2
  spider_type: visual  # VisualDiscoverySpider
  urls:
    - https://example.com
  depth: 2
  mode: domain
  custom_settings:
    CLOSESPIDER_TIMEOUT: 10800  # 3 hours max
    IMAGES_STORE: /data/screenshots

# Workflow spider for login-required areas (weekly)
authenticated_area_check:
  schedule_type: cron
  day_of_week: wed  # Every Wednesday
  hour: 3  # Run at 3 AM UTC
  minute: 0
  spider_type: workflow  # WorkflowSpider
  urls:
    - https://example.com/login
  custom_settings:
    WORKFLOW_FILE: /app/workflows/login_sequence.json
    CLOSESPIDER_TIMEOUT: 3600  # 1 hour max